# ============================================================================
# ComicRack Community Edition - Docker Compose Configuration
# ============================================================================

services:
  comicrack:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        PROTON_GE_VERSION: GE-Proton10-29
    container_name: comicrack-web
    image: comicrack-web
    restart: unless-stopped

    # ------------------------------------------------------------------------
    # Network Ports
    # ------------------------------------------------------------------------
    ports:
      - "5700:3000"   # HTTP Web Interface
      - "5701:3001"   # HTTPS Web Interface

    # ------------------------------------------------------------------------
    # Volumes
    # ------------------------------------------------------------------------
    volumes:
      # Comic library (read comics from here)
      - ./library:/library
      # General data directory
      - ./data:/data
      # Import directory (for new comics)
      - ./import:/import
      # ComicRack AppData (settings, database)
      - ./data/comicrack:/config/.wine/drive_c/users/steamuser/AppData/Roaming/cYo/ComicRack Community Edition
      # Persistent config (Wine prefix, desktop settings)
      - comicrack-config:/config

    # ------------------------------------------------------------------------
    # Environment Variables
    # ------------------------------------------------------------------------
    environment:
      # User/Group IDs
      - PUID=1000
      - PGID=1000

      # Locale
      - LC_ALL=fr_FR.UTF-8

      # Keyboard Layout
      - KEYBOARD=fr-fr-azerty

      # Window Title
      - TITLE=ComicRack-Web

      # Webtop/Selkies Resolution
      - CUSTOM_USER=abc
      - SELKIES_MANUAL_WIDTH=1280
      - SELKIES_MANUAL_HEIGHT=800

      # Wine Configuration
      - WINETRICKS_PACKAGES=dotnet48 corefonts mono gecko

      # Application Directories
      - DATA_DIR=/data
      - IMPORT_DIR=/import

# ============================================================================
# Named Volumes
# ============================================================================
volumes:
  comicrack-config:
