services:
  comicrack:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: comicrack-web
    image: comicrack-web
    ports:
      - "5700:3000"   # Selkies HTTP
      - "5701:3001"   # Selkies HTTPS
    volumes:
      - ./library:/library
    user: "1000:1000"
    environment:
      # Mode X11 — Selkies lance Xvfb + Openbox, wine tourne sur DISPLAY=:1
      - SELKIES_MANUAL_WIDTH=1280
      - SELKIES_MANUAL_HEIGHT=800
      - WINE_DPI=150 # 96=défaut, 150=bon pour 1280x720, 192=pour les écrans 4K
      - CURSOR_SIZE=400
      - XCURSOR_THEME=default
      - WINE_FONT=Arial
      - COMIC_DARK=1
      - USE_PROTON=1
      - WINETRICKS_PACKAGES=dotnet48 corefonts mono gecko
      - CURSOR_PACK=1
      - CURSOR_PACK_VARIANT=default
      # Standard LSIO permissions.
      - PUID=1000
      - PGID=1000
      - TITLE=ComicRack-Web
    restart: unless-stopped
